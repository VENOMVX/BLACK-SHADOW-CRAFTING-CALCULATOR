<!DOCTYPE html>
<html>
<head>
  <title>Black Shadow's Crafting Calculator</title>
  <link href="https://fonts.cdnfonts.com/css/pricedown" rel="stylesheet">
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #121212;
      color: #eee;
      padding: 20px;
      background-image: url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1600&q=80');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      position: relative;
      min-height: 100vh;
    }
    body::before {
      content: "";
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(18,18,18,0.70);
      z-index: 0;
      pointer-events: none;
    }
    #content {
      position: relative;
      z-index: 1;
    }
    h1 {
      color: #ffe900;
      font-family: 'Pricedown', Arial, sans-serif;
      font-size: 2.8em;
      text-shadow: 3px 3px 0 #000, 6px 6px 0 #333;
      letter-spacing: 1px;
      margin-bottom: 20px;
      margin-top: 0;
    }
    .btn {
      display: inline-block;
      padding: 12px 36px;
      font-size: 1.1em;
      font-family: 'Pricedown', Arial, sans-serif;
      color: #fff;
      background: linear-gradient(90deg,#00ffcc 0%,#ffe900 100%);
      border: none;
      border-radius: 10px;
      letter-spacing: 2px;
      text-shadow: 2px 2px 0 #333, 4px 4px 0 #111;
      cursor: pointer;
      margin-bottom: 18px;
      margin-top: 0;
      box-shadow: 0 2px 12px #00000077;
      transition: transform 0.1s;
      text-decoration: none;
    }
    .btn:hover {
      transform: scale(1.045);
      background: linear-gradient(90deg,#ffe900 0%,#00ffcc 100%);
    }
    select, input, button {
      padding: 8px;
      margin: 10px 0;
      font-size: 16px;
    }
    .output {
      margin-top: 20px;
      background-color: #1e1e1e;
      padding: 15px;
      border-radius: 8px;
      white-space: pre-wrap;
    }
    #recipeContainer h3 {
      margin-top: 1em;
      color: #2a9d8f;
      font-size: 1.2em;
    }
    .recipe {
      padding-left: 1em;
    }
  </style>
</head>
<body>
  <div id="content">
    <a href="intro.html" class="btn">‚è™ Back to Intro</a>
    <h1>üîß Black Shadow's Crafting Calculator</h1>

    <label for="item">Choose item:</label><br>
    <select id="item" onchange="handleItemChange(); calculate();">
      <option value="">-- Select an item --</option>
      <!-- Weapons -->
      <option value="PM Pistol">PM Pistol</option>
      <option value="M9 Pistol">M9 Pistol</option>
      <option value="Colt 1911 Pistol">Colt 1911 Pistol</option>
      <option value="M16A2 Rifle">M16A2 Rifle</option>
      <option value="MP5A2 Sub-Machine Gun">MP5A2 Sub-Machine Gun</option>
      <!-- Vehicles -->
      <option value="M151A2 Off-Road">M151A2 Off-Road</option>
      <option value="UH-1 Helicopter">UH-1 Helicopter</option>
      <option value="MI-8 Helicopter">MI-8 Helicopter</option>
      <option value="S105 Car (Blue)">S105 Car (Blue)</option>
      <option value="S1203 Lab">S1203 Lab</option>
      <option value="S1203 Minibus">S1203 Minibus</option>
      <option value="UAZ-452 Van">UAZ-452 Van</option>
      <option value="M998 L.U.V">M998 L.U.V</option>
      <option value="M998 L.U.V (Canopy)">M998 L.U.V (Canopy)</option>
      <option value="M1025 Light-Armoured Vehicle">M1025 Light-Armoured Vehicle</option>
      <option value="PickUp Truck">PickUp Truck</option>
      <option value="VW Golf">VW Golf</option>
      <!-- Trucks -->
      <option value="M923A1 Transport Truck (Canopy)">M923A1 Transport Truck (Canopy)</option>
      <option value="Ural Fuel Truck">Ural Fuel Truck</option>
      <option value="Ural Transport Truck">Ural Transport Truck</option>
      <option value="Ural Canopy">Ural Canopy</option>
      <!-- Helmets -->
      <option value="Ballistic Helmet">Ballistic Helmet</option>
      <option value="Assault Helmet">Assault Helmet</option>
      <option value="Heavy Assault Helmet">Heavy Assault Helmet</option>
      <!-- Vests -->
      <option value="Light Vest">Light Vest</option>
      <option value="Heavy Vest">Heavy Vest</option>
      <option value="Assault Vest">Assault Vest</option>
      <option value="Plate Carrier Vest">Plate Carrier Vest</option>
    </select><br>

    <label for="qty">Quantity:</label><br>
    <input type="number" id="qty" value="1" min="1"><br>

    <label for="sortType">Sort Recipes:</label><br>
    <select id="sortType" onchange="handleSortChange()">
      <option value="none">-- No Sorting --</option>
      <option value="alphabetical">Sort by Type (A‚ÄìZ)</option>
      <option value="grouped">Group by Type</option>
    </select><br>

    <button onclick="calculate()">Calculate</button>
    <div class="output" id="output"></div>
  </div>
  <script>
    // Recipes for all items in dropdown.
    // Vests and helmets only display Cloth and Iron Plate; Plate Carrier Vest shows Kevlar too.
    const recipes = {
      // Weapons
      "PM Pistol": { type: "Weapon", "Weapon Part": 4, "Stabilizer": 2, "Component": 2 },
      "M9 Pistol": { type: "Weapon", "Weapon Part": 3, "Stabilizer": 2, "Component": 2 },
      "Colt 1911 Pistol": { type: "Weapon", "Weapon Part": 4, "Stabilizer": 2, "Component": 2 },
      "M16A2 Rifle": { type: "Weapon", "Weapon Part": 5, "Stabilizer": 3, "Component": 3 },
      "MP5A2 Sub-Machine Gun": { type: "Weapon", "Weapon Part": 6, "Stabilizer": 3, "Component": 3 },
      // Vehicles
      "M151A2 Off-Road": { type: "Vehicle", "Mechanical Component": 8, "Interior Part": 5, "Engine Part": 8 },
      "UH-1 Helicopter": { type: "Vehicle", "Mechanical Component": 12, "Interior Part": 9, "Engine Part": 12, "Special Rotor": 1 },
      "MI-8 Helicopter": { type: "Vehicle", "Mechanical Component": 18, "Interior Part": 13, "Engine Part": 18, "Special Rotor": 1 },
      "S105 Car (Blue)": { type: "Vehicle", "Mechanical Component": 14, "Interior Part": 8, "Engine Part": 14 },
      "S1203 Lab": { type: "Vehicle", "Mechanical Component": 16, "Interior Part": 10, "Engine Part": 16 },
      "S1203 Minibus": { type: "Vehicle", "Mechanical Component": 17, "Interior Part": 11, "Engine Part": 17 },
      "UAZ-452 Van": { type: "Vehicle", "Mechanical Component": 21, "Interior Part": 13, "Engine Part": 21 },
      "M998 L.U.V": { type: "Vehicle", "Mechanical Component": 5, "Interior Part": 3, "Engine Part": 5 },
      "M998 L.U.V (Canopy)": { type: "Vehicle", "Mechanical Component": 6, "Interior Part": 4, "Engine Part": 6 },
      "M1025 Light-Armoured Vehicle": { type: "Vehicle", "Mechanical Component": 9, "Interior Part": 5, "Engine Part": 9 },
      "PickUp Truck": { type: "Vehicle", "Mechanical Component": 19, "Interior Part": 11, "Engine Part": 19 },
      "VW Golf": { type: "Vehicle", "Mechanical Component": 31, "Interior Part": 19, "Engine Part": 31 },
      // Trucks
      "M923A1 Transport Truck (Canopy)": { type: "Truck", "Mechanical Component (HQ)": 2, "Interior Part (HQ)": 2, "Engine Part (HQ)": 1 },
      "Ural Fuel Truck": { type: "Truck", "Mechanical Component (HQ)": 4, "Interior Part (HQ)": 3, "Engine Part (HQ)": 2 },
      "Ural Transport Truck": { type: "Truck", "Mechanical Component (HQ)": 4, "Interior Part (HQ)": 3, "Engine Part (HQ)": 2 },
      "Ural Canopy": { type: "Truck", "Mechanical Component (HQ)": 5, "Interior Part (HQ)": 5, "Engine Part (HQ)": 3 },
      // Helmets (only display Cloth and Iron Plate)
      "Ballistic Helmet": { type: "Helmet", "Cloth": 2, "Iron Plate": 1 },
      "Assault Helmet": { type: "Helmet", "Cloth": 3, "Iron Plate": 2 },
      "Heavy Assault Helmet": { type: "Helmet", "Cloth": 4, "Iron Plate": 3 },
      // Vests (only display Cloth and Iron Plate, Plate Carrier Vest includes Kevlar)
      "Light Vest": { type: "Vest", "Cloth": 5, "Iron Plate": 2 },
      "Heavy Vest": { type: "Vest", "Cloth": 8, "Iron Plate": 4 },
      "Assault Vest": { type: "Vest", "Cloth": 6, "Iron Plate": 3 },
      "Plate Carrier Vest": { type: "Vest", "Cloth": 10, "Iron Plate": 5, "Kevlar": 2 }
    };

    // Max quantities for item categories
    const itemMaxQuantities = {
      "Weapon": 100,
      "Vehicle": 50,
      "Truck": 50,
      "Helmet": 100,
      "Vest": 100
    };

    function getItemCategory(item) {
      // Returns the category string for the item based on recipes.type
      return recipes[item]?.type || null;
    }

    function handleItemChange() {
      const item = document.getElementById("item").value;
      const qtyInput = document.getElementById("qty");
      if (!item) {
        qtyInput.max = 100; // default max
        return;
      }
      const type = getItemCategory(item);
      if (type && itemMaxQuantities[type]) {
        qtyInput.max = itemMaxQuantities[type];
      } else {
        qtyInput.max = 100; // fallback default
      }
      // If current value exceeds new max, set to max
      if (parseInt(qtyInput.value) > parseInt(qtyInput.max)) {
        qtyInput.value = qtyInput.max;
      }
    }

    function sortRecipesByType(recipesObj) {
      return Object.entries(recipesObj)
        .map(([name, data]) => ({ name, ...data }))
        .sort((a, b) => (a.type || "").localeCompare(b.type || ""));
    }

    function groupRecipesByType(recipesObj) {
      const grouped = {};
      for (const [name, data] of Object.entries(recipesObj)) {
        const type = data.type || "Unknown";
        if (!grouped[type]) grouped[type] = [];
        grouped[type].push({ name, ...data });
      }
      return grouped;
    }

    function renderGroupedRecipes(grouped) {
      const container = document.getElementById("output");
      container.innerHTML = "";
      for (const type in grouped) {
        const header = document.createElement("h3");
        header.textContent = type;
        container.appendChild(header);
        grouped[type].forEach(recipe => {
          const div = document.createElement("div");
          div.className = "recipe";
          div.textContent = recipe.name;
          container.appendChild(div);
        });
      }
    }

    function renderRecipes(recipeList) {
      const container = document.getElementById("output");
      container.innerText = "üßæ Available Recipes:\n" + recipeList.map(r => r.name).join("\n");
    }

    function handleSortChange() {
      const value = document.getElementById("sortType").value;
      if (value === "alphabetical") {
        const sorted = sortRecipesByType(recipes);
        renderRecipes(sorted);
      } else if (value === "grouped") {
        const grouped = groupRecipesByType(recipes);
        renderGroupedRecipes(grouped);
      } else {
        renderRecipes(Object.entries(recipes).map(([name, data]) => ({ name, ...data })));
      }
    }

    function calculate() {
      const item = document.getElementById("item").value;
      const qty = parseInt(document.getElementById("qty").value);
      const recipe = recipes[item];
      const output = [];

      if (!recipe) {
        document.getElementById("output").innerText = "‚ùå Item not found or not selected.";
        return;
      }

      output.push(`üî© Materials for ${qty} √ó ${item}:\n`);

      // For helmets, only display Cloth and Iron Plate
      if (recipe.type === "Helmet") {
        if (recipe["Cloth"]) output.push(`Cloth: ${recipe["Cloth"] * qty}`);
        if (recipe["Iron Plate"]) output.push(`Iron Plate: ${recipe["Iron Plate"] * qty}`);
      }
      // For vests, only display Cloth and Iron Plate, Plate Carrier Vest adds Kevlar
      else if (recipe.type === "Vest") {
        if (recipe["Cloth"]) output.push(`Cloth: ${recipe["Cloth"] * qty}`);
        if (recipe["Iron Plate"]) output.push(`Iron Plate: ${recipe["Iron Plate"] * qty}`);
        if (item === "Plate Carrier Vest" && recipe["Kevlar"]) output.push(`Kevlar: ${recipe["Kevlar"] * qty}`);
      }
      // Otherwise display all parts
      else {
        for (const [part, count] of Object.entries(recipe)) {
          if (part !== "type") {
            const total = count * qty;
            output.push(`${part}: ${total}`);
          }
        }
      }

      document.getElementById("output").innerText = output.join("\n");
    }

    window.onload = () => {
      renderRecipes(Object.entries(recipes).map(([name, data]) => ({ name, ...data })));
      handleItemChange();
    };
  </script>
</body>
</html>
